[English](../../README.md) | [中文](README.md)

## 目录

- [✨ 功能特点](#功能特点1)
- [📖 使用指南](#使用指南)
- [🔬 研究模式](#研究模式)
- [🧠 任务记忆功能](#任务记忆功能)
- [📋 项目规范初始化](#项目规范初始化)
- [🌐 网页图形界面](#网页图形界面)
- [📚 文件资源](#文件资源)
- [🔧 安装与使用](#安装与使用)
- [🔌 在支持 MCP 的客户端中使用](#客户端中使用)
- [💡 系统提示词指导](#系统提示词指导)
- [🛠️ 可用工具一览](#可用工具一览)
- [📄 许可协议](#许可协议)
- [🤖 推荐模型](#推荐模型)

# MCP 虾米任务管理器

[![Shrimp Task Manager Demo](/docs/yt.png)](https://www.youtube.com/watch?v=Arzu0lV09so)

[![smithery badge](https://smithery.ai/badge/@cjo4m06/mcp-shrimp-task-manager)](https://smithery.ai/server/@cjo4m06/mcp-shrimp-task-manager)

> 🚀 基于 Model Context Protocol (MCP) 的智能任务管理系统，为 AI Agent 提供高效的程序开发工作流程框架。

虾米任务管理器通过结构化的工作流程引导，协助 Agent 系统性规划程序开发步骤，强化任务记忆管理机制，有效避免冗余与重复的编程工作。

## ✨ <a id="功能特点1"></a>功能特点

- **任务规划与分析**：深入理解与分析复杂任务需求
- **智能任务拆分**：将大型任务自动拆分为可管理的小型任务
- **依赖关系管理**：精确处理任务间的依赖关系，确保正确的执行顺序
- **执行状态跟踪**：即时监控任务执行进度和状态
- **任务完整性验证**：确保任务成果符合预期要求
- **任务复杂度评估**：自动评估任务复杂度并提供最佳处理建议
- **任务摘要自动更新**：完成任务时自动产生摘要，优化记忆效能
- **任务记忆功能**：自动备份任务历史记录，提供长期记忆和参考能力
- **思维链过程**：通过步骤化的推理系统性地分析复杂问题
- **研究模式**：系统性技术研究功能，提供引导式工作流程来探索技术、最佳实践和解决方案比较
- **项目规范初始化**：定义项目标准和规则，维持大型项目的一致性
- **<a id="网页图形界面"></a>网页图形界面**：提供选用的网页图形化用户界面来管理任务。通过在您的 `.env` 文件中设定 `ENABLE_GUI=true` 来启用。启用后，将会在您的 `DATA_DIR` 中建立一个包含访问网址的 `WebGUI.md` 文件。
- **多实例支持**：支持多个 MCP 实例并发运行，具有独立的数据目录和文件锁机制，防止数据冲突。

## 🧭 <a id="使用指南"></a>使用指南

虾米任务管理器提供结构化的 AI 辅助程序开发方法，通过引导式工作流程和系统化任务管理实现高效开发。

### 什么是虾米？

虾米本质上是一个提示词模板，通过一系列提示词引导 AI Agent 更好地理解和适应您的项目。它确保 Agent 能够更贴近您项目的特定需求和惯例。

### 实际应用中的研究模式

在深入任务规划之前，您可以善用研究模式进行技术调查和知识收集。这在以下情况特别有用：

- 您需要探索新的技术或框架
- 您想要比较不同的解决方案方法
- 您正在调查项目的最佳实践
- 您需要理解复杂的技术概念

只需告诉 Agent「研究 [您的主题]」或「进入研究模式研究 [技术/问题]」即可开始系统性调查。研究发现将为您后续的任务规划和开发决策提供信息基础。

### 首次使用设置

在使用新项目时，只需对 Agent 说「init project rules」（初始化项目规则）。这将引导 Agent 生成一份符合您项目特定需求和结构的规则文件。

### 任务规划流程

要开发或更新功能，使用命令「plan task [您的描述]」（规划任务 [您的描述]）。系统将参考先前建立的规则，尝试理解您的项目，搜索相关程序代码区块，并根据项目的当前状态提出全面的计划。

### 反馈机制

在规划过程中，虾米引导 Agent 进行多步骤思考。您可以审查这个过程，如果您觉得某个部分偏离了您的目标，可以直接打断并提出您的观点。Agent 将采纳您的反馈并继续思考过程。

### 任务执行

当您对规划内容满意后，使用「execute task [任务名称或 ID]」（执行任务 [任务名称或 ID]）来实施计划。如果您不指定任务名称或 ID，系统将自动识别并执行最优先的任务。

### 连续模式

如果您希望连续执行所有任务而不需要为每个任务手动干预，可以使用「continuous mode」（连续模式）自动处理整个任务队列。

### Token 限制注意事项

由于 LLM 的 Token 限制，在长时间对话中可能会丧失上下文。如果发生这种情况，只需开启新的聊天会话并请 Agent 继续执行即可。系统将从上次中断的地方继续，无需重复任务细节或上下文。

### 提示词语言与定制化

您可以通过设定 `TEMPLATES_USE` 环境变量来切换系统提示词的语言。预设支持 `en`（英文）和 `zh`（简体中文）。此外，您也可以复制现有的模板目录（例如 `src/prompts/templates_en`）到 `DATA_DIR` 指定的位置，进行修改后，将 `TEMPLATES_USE` 指向您的定制化模板目录名称，以实现更深度的提示词定制化

## 🔬 <a id="研究模式"></a>研究模式

虾米任务管理器包含专门的研究模式，专为系统性技术调查和知识收集而设计。

### 什么是研究模式？

研究模式是一个引导式工作流程系统，帮助 AI Agent 进行彻底且系统性的技术研究。它提供结构化的方法来探索技术、比较解决方案、调查最佳实践，并为程序设计任务收集全面的信息。

### 主要功能

- **系统性调查**：结构化工作流程确保研究主题的全面覆盖
- **多源研究**：结合网络搜索和程序代码库分析，实现完整理解
- **状态管理**：在多个会话中维护研究上下文和进度
- **引导式探索**：防止研究变得不专注或偏离主题
- **知识整合**：将研究发现与任务规划和执行无缝整合

### 何时使用研究模式

研究模式特别适用于：

- **技术探索**：调查新的框架、函数库或工具
- **最佳实践研究**：寻找行业标准和推荐方法
- **解决方案比较**：评估不同的技术方法或架构
- **问题调查**：深入研究复杂的技术挑战
- **架构规划**：研究设计模式和系统架构

### 如何使用研究模式

只需告诉 Agent 进入研究模式并指定您的主题：

- **基本用法**：「进入研究模式研究 [您的主题]」
- **特定研究**：「研究 [特定技术/问题]」
- **比较分析**：「研究并比较 [选项 A 与选项 B]」

系统将引导 Agent 通过结构化的研究阶段，确保彻底调查的同时保持对您特定需求的专注。

### 研究工作流程

1. **主题定义**：明确定义研究范围和目标
2. **信息收集**：系统性收集相关信息
3. **分析与综合**：处理和组织研究发现
4. **状态更新**：定期进度跟踪和上下文保存
5. **整合应用**：将研究结果应用到您的项目上下文中

> **💡 建议**：为了获得最佳的研究模式体验，我们建议使用 **Claude 4 Sonnet**，它提供卓越的分析能力和全面的研究综合功能。

## 🧠 <a id="任务记忆功能"></a>任务记忆功能

虾米任务管理器具备长期记忆功能，可以自动保存任务执行的历史记录，并在规划新任务时提供参考经验。

### 功能特点

- 系统会自动将任务备份到 memory 目录中
- 备份文件按照时间顺序命名，格式为 tasks_backup_YYYY-MM-DDThh-mm-ss.json
- 任务规划 Agent 会自动获得关于如何利用记忆功能的指导

### 优势与效益

- **避免重复工作**：参考过去任务，不必从零开始解决类似问题
- **借鉴成功经验**：利用已验证有效的解决方案，提高开发效率
- **学习与改进**：识别过去的错误或低效方案，持续优化工作流程
- **知识沉淀**：随着系统使用时间增长，形成持续扩展的知识库

通过有效利用任务记忆功能，系统能够不断积累经验，智能化程度和工作效率将持续提升。

## 📋 <a id="项目规范初始化"></a>项目规范初始化

项目规范功能有助于维持代码库的一致性：

- **标准化开发**：建立一致的编码模式和实践
- **新开发者引导**：为项目贡献提供明确的指南
- **维持品质**：确保所有代码符合既定的项目标准

> **⚠️ 建议**：当项目规模不断扩大或发生重大变更时，请初始化项目规范。这有助于在复杂度增加时维持一致性和品质。

在以下情况使用 `init_project_rules` 工具设置或更新项目标准：

- 启动新的大型项目
- 有新团队成员加入
- 实施重大架构变更
- 采用新的开发惯例

### 使用示例

您可以通过简单的自然语言指令轻松使用此功能：

- **首次设定时**：只需对 Agent 说「初始化规则」或「初始化项目规则」
- **需要更新时**：当项目发展变化时，对 Agent 说「更新规则」或「更新项目规则」

当您的代码库扩展或经历重大结构变化时，此工具特别有价值，有助于在整个项目生命周期中保持一致的开发实践。

## 📚 <a id="文件资源"></a>文件资源

- [提示词自定义指南](prompt-customization.md)：通过环境变量自定义工具提示词的说明
- [更新日志](CHANGELOG.md)：记录此项目的所有重要变更

## 🔧 <a id="安装与使用"></a>安装与使用

### Installing via Smithery

To install 蝦米任務管理器 for Claude Desktop automatically via [Smithery](https://smithery.ai/server/@cjo4m06/mcp-shrimp-task-manager):

```bash
npx -y @smithery/cli install @cjo4m06/mcp-shrimp-task-manager --client claude
```

### Manual Installation

```bash
# 安装依赖包
npm install

# 构建并启动服务
npm run build
```

## 🔌 <a id="客户端中使用"></a>在支持 MCP 的客户端中使用

虾米任务管理器可以与任何支持 Model Context Protocol 的客户端一起使用，例如 Cursor IDE。

### 在 Cursor IDE 中配置

虾米任务管理器提供两种配置方式：全局配置和项目特定配置。

#### 全局配置

1. 打开 Cursor IDE 的全局设定文件（通常位于 `~/.cursor/mcp.json`）
2. 在 `mcpServers` 区段中添加以下配置：

```json
{
  "mcpServers": {
    "shrimp-task-manager": {
      "command": "node",
      "args": ["/mcp-shrimp-task-manager/dist/index.js"],
      "env": {
        "DATA_DIR": "/mcp-shrimp-task-manager/data",
        "TEMPLATES_USE": "en",
        "ENABLE_GUI": "false"
      }
    }
  }
}

or

{
  "mcpServers": {
    "shrimp-task-manager": {
      "command": "npx",
      "args": ["-y", "mcp-shrimp-task-manager"],
      "env": {
        "DATA_DIR": "/mcp-shrimp-task-manager/data",
        "TEMPLATES_USE": "en",
        "ENABLE_GUI": "false"
      }
    }
  }
}
```

> ⚠️ 请将 `/mcp-shrimp-task-manager` 替换为您的实际路径。

#### 项目特定配置

您也可以为每个项目设定专属配置，以便针对不同项目使用独立的数据目录：

1. 在项目根目录创建 `.cursor` 目录
2. 在该目录下创建 `mcp.json` 文件，内容如下：

```json
{
  "mcpServers": {
    "shrimp-task-manager": {
      "command": "node",
      "args": ["/path/to/mcp-shrimp-task-manager/dist/index.js"],
      "env": {
        "TEMPLATES_USE": "en",
        "ENABLE_GUI": "false"
      }
    }
  }
}

or

{
  "mcpServers": {
    "shrimp-task-manager": {
      "command": "npx",
      "args": ["-y", "mcp-shrimp-task-manager"],
      "env": {
        "TEMPLATES_USE": "en",
        "ENABLE_GUI": "false"
      }
    }
  }
}
```

### ⚠️ 重要配置说明

**重要变更**: `DATA_DIR` 环境变量已被移除。现在所有工具都必须通过 `dataDir` 参数明确指定数据目录，这确保了更好的项目隔离和数据安全性。

> **注意**:
>
> - 所有工具调用时都必须提供 `dataDir` 参数
> - 数据将存储在 `dataDir/.shrimp_task/` 目录中
> - 不同项目使用完全独立的数据目录
> - 提高了系统的可预测性和安全性

### 🔧 环境变量配置

虾米任务管理器支持通过环境变量自定义提示词行为，让您无需修改程序代码即可微调 AI 助手的回应。您可以在配置中或通过 `.env` 文件设置这些变量：

```json
{
  "mcpServers": {
    "shrimp-task-manager": {
      "command": "node",
      "args": ["/path/to/mcp-shrimp-task-manager/dist/index.js"],
      "env": {
        "MCP_PROMPT_PLAN_TASK": "自定义规划指导...",
        "MCP_PROMPT_EXECUTE_TASK_APPEND": "附加执行说明...",
        "TEMPLATES_USE": "en",
        "ENABLE_GUI": "false"
      }
    }
  }
}
```

提供两种自定义方式：

- **覆盖模式**（`MCP_PROMPT_[FUNCTION_NAME]`）：完全替换预设提示词
- **追加模式**（`MCP_PROMPT_[FUNCTION_NAME]_APPEND`）：在现有提示词基础上增加内容

此外，还有其他系统配置变量：

- **DATA_DIR**：指定任务数据存储的目录
- **TEMPLATES_USE**：指定提示词使用的模板集。预设为 `en`。目前可用的选项有 `en` 和 `zh`。若要使用自定义模板，请将 `src/prompts/templates_en` 目录复制到 `DATA_DIR` 指定的位置，重新命名复制的目录（例如，`my_templates`），并将 `TEMPLATES_USE` 设置为新的目录名称（例如，`my_templates`）。

有关自定义提示词的详细说明，包括支持的参数和示例，请参阅[提示词自定义指南](prompt-customization.md)。

## 💡 <a id="系统提示词指导"></a>系统提示词指导

### Cursor IDE 配置

您可以启用 Cursor Settings => Features => Custom modes 功能，并配置以下两个模式：

#### TaskPlanner 模式

```
你是一个专业的任务规划专家，你必须与用户进行交互，分析用户的需求，并收集项目相关信息，最终使用 「plan_task」 建立任务，当任务建立完成后必须总结摘要，并告知用户使用「TaskExecutor」模式进行任务执行。
你必须专心于任务规划禁止使用 「execute_task」 来执行任务，
严重警告你是任务规划专家，你不能直接修改程序代码，你只能规划任务，并且你不能直接修改程序代码，你只能规划任务。
```

#### TaskExecutor 模式

```
你是一个专业的任务执行专家，当用户有指定执行任务，则使用 「execute_task」 进行任务执行，
没有指定任务时则使用 「list_tasks」 寻找未执行的任务并执行，
当执行完成后必须总结摘要告知用户结论，
你一次只能执行一个任务，当任务完成时除非用户明确告知否则禁止进行下一则任务。
用户如果要求「连续模式」则按照顺序连续执行所有任务
```

> 💡 根据您的需求场景选择适当的模式：
>
> - 当需要规划任务时使用 **TaskPlanner** 模式
> - 当需要执行任务时使用 **TaskExecutor** 模式

### 在其他工具中使用

如果您的工具不支持 Custom modes 功能，可以：

- 在不同阶段手动贴上相应的提示词
- 或直接使用简单命令如 `请规划以下任务：......` 或 `请开始执行任务...`

## 🛠️ <a id="可用工具一览"></a>可用工具一览

配置完成后，您可使用以下工具：

### 多实例支持

所有数据访问工具现在都要求必须提供 `dataDir` 参数，用于多实例部署：

- **用途**：允许多个 MCP 实例并发运行，使用独立的数据目录
- **使用方法**：必须在所有工具调用中提供 `"dataDir": "/path/to/your/data"`
- **要求**：`dataDir` 参数现在是所有工具的必需参数
- **并发安全**：文件锁机制防止并发访问时的数据冲突

详细信息请参阅 [工具参数设计指南](tool-parameter-design.md)。

| 功能分类     | 工具名称             | 功能描述                   |
| ------------ | -------------------- | -------------------------- |
| **任务规划** | `plan_task`          | 开始规划任务               |
| **任务分析** | `analyze_task`       | 深入分析任务需求           |
|              | `process_thought`    | 针对复杂问题进行步骤化推理 |
| **方案评估** | `reflect_task`       | 反思与改进方案构想         |
| **研究调查** | `research_mode`      | 进入系统性技术研究模式     |
| **项目管理** | `init_project_rules` | 初始化或更新项目标准与规则 |
| **任务管理** | `split_tasks`        | 将任务拆分为子任务         |
|              | `list_tasks`         | 显示所有任务及状态         |
|              | `query_task`         | 搜索并列出任务             |
|              | `get_task_detail`    | 显示完整任务详情           |
|              | `delete_task`        | 删除未完成的任务           |
| **任务执行** | `execute_task`       | 执行特定任务               |
|              | `verify_task`        | 检验任务完成情况           |

## 📄 <a id="许可协议"></a>许可协议

此项目根据 MIT 许可协议授权 - 详情请参阅 [LICENSE](../../LICENSE) 文件。

## 🤖 <a id="推荐模型"></a>推荐模型

为了获得最佳体验，建议使用以下模型：

- **Claude 3.7**: 提供强大的理解和生成能力。
- **Gemini 2.5**: Google 的最新模型，表现优异。

由于不同模型的训练方式和理解能力存在差异，使用其他模型可能会导致相同的提示词产生不同的效果。本项目已针对 Claude 3.7 和 Gemini 2.5 进行了最佳化。

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=cjo4m06/mcp-shrimp-task-manager&type=Timeline)](https://www.star-history.com/#cjo4m06/mcp-shrimp-task-manager&Timeline)
